<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sessions de Ramassage de DÃ©chets</title>
    <link rel="stylesheet" href="global.css">

    <!-- Leaflet -->
    <link
        rel="stylesheet"
        href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <script
        src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js">
    </script>

</head>

<body>
<div id="header"></div>

<div class="container">
    <div>
        <h1>ğŸŒ Sessions de Ramassage de DÃ©chets</h1>
        <p class="subtitle">Rejoignez-nous pour nettoyer nos plages !</p>
    </div>

    <div class="content">
        <div class="left-section">
            <div class="session-list" id="sessionList"></div>

            <div class="registration-form" id="registrationForm">
                <h2 class="form-title">Formulaire d'inscription</h2>
                <form id="userForm">

                    <div class="form-group">
                        <label for="nom">Nom <span class="required">*</span></label>
                        <input type="text" id="nom" name="nom" required>
                    </div>

                    <div class="form-group">
                        <label for="prenom">PrÃ©nom <span class="required">*</span></label>
                        <input type="text" id="prenom" name="prenom" required>
                    </div>

                    <div class="form-group">
                        <label for="email">Email <span class="required">*</span></label>
                        <input type="email" id="email" name="email" required>
                    </div>

                    <div class="form-group">
                        <label for="telephone">TÃ©lÃ©phone <span class="required">*</span></label>
                        <input type="tel" id="telephone" name="telephone" required>
                    </div>

                    <div class="form-group">
                        <label for="adresse">Adresse <span class="required">*</span></label>
                        <input type="text" id="adresse" name="adresse" required>
                    </div>

                    <div class="form-group">
                        <label for="codePostal">Code postal <span class="required">*</span></label>
                        <input type="text" id="codePostal" name="codePostal" required>
                    </div>

                    <button type="submit" class="btn-primary">
                        Confirmer mon inscription
                    </button>
                </form>
            </div>

            <div class="success-message" id="successMessage">
                <h2>âœ… Inscription confirmÃ©e</h2>
                <p>Merci pour votre engagement en faveur du littoral. Vous recevrez un e-mail de confirmation prochainement.</p>
            </div>
        </div>

        <div class="right-section">
            <div class="map-container">
                <h3 class="map-title">ğŸ“ Carte des Ã©vÃ©nements</h3>
                <div id="map"></div>
            </div>
        </div>
    </div>
</div>

<div id="footer"></div>

<script>
const sessions = [
    { 
        id: 1, 
        titre: "Nettoyage Plage de PlouzanÃ©", 
        date: "Samedi 15 mars 2025", 
        horaire: "09h - 12h", 
        plage: "Plage du Petit Minou", 
        lieu: "PlouzanÃ©",
        lat: 48.34173,
        lng: -4.61595
    },
    { 
        id: 2, 
        titre: "Ramassage Plougastel", 
        date: "Dimanche 16 mars 2025", 
        horaire: "14h - 17h", 
        plage: "Plage de Porz Don", 
        lieu: "Plougastel",
        lat: 48.35237,
        lng: -4.33236 
    },
    {
        id: 3,
        titre: "Nettoyage Plage de Brest",
        date: "Samedi 22 mars 2025",
        horaire: "10h - 13h",
        plage: "Plage du Moulin Blanc",
        lieu: "Brest",
        lat: 48.39897,
        lng: -4.42625
    },
    {
        id: 4,
        titre: "Ramassage Plage de Crozon",
        date: "Dimanche 23 mars 2025",
        horaire: "08h30 - 11h30",
        plage: "Plage de l'Aber",
        lieu: "Crozon",
        lat: 48.23407,
        lng: -4.44517

    }
];

let selectedSessionId = null;

function renderSessions() {
    document.getElementById("sessionList").innerHTML = sessions.map(s => `
        <div class="session-item" data-id="${s.id}">
            <div class="session-header">
                <div>
                    <h3 class="session-title">${s.titre}</h3>
                </div>
                <button class="btn-secondary" onclick="selectSession(${s.id})">
                    Je participe
                </button>
            </div>
            <div class="session-info">
                <div class="info-row">
                    <span>ğŸ“… ${s.date}</span>
                </div>
                <div class="info-row">
                    <span>ğŸ•’ ${s.horaire}</span>
                </div>
                <div class="info-row">
                    <span>ğŸ–ï¸ ${s.plage}</span>
                </div>
                <div class="info-row">
                    <span>ğŸ“ ${s.lieu}</span>
                </div>
            </div>
        </div>
    `).join("");
}

function selectSession(id) {
    selectedSessionId = id;
    
    // Mettre Ã  jour l'apparence des sessions
    document.querySelectorAll('.session-item').forEach(item => {
        item.classList.remove('selected');
        const btn = item.querySelector('.btn-secondary');
        btn.textContent = 'Je participe';
        btn.classList.remove('selected');
    });

    // Marquer la session sÃ©lectionnÃ©e
    const selectedItem = document.querySelector(`[data-id="${id}"]`);
    selectedItem.classList.add('selected');
    const selectedBtn = selectedItem.querySelector('.btn-secondary');
    selectedBtn.textContent = 'âœ“ SÃ©lectionnÃ©';
    selectedBtn.classList.add('selected');

    // Afficher le formulaire et masquer le message de succÃ¨s
    document.getElementById("registrationForm").classList.add("active");
    document.getElementById("successMessage").classList.remove("active");
    
    // Scroll vers le formulaire
    document.getElementById('registrationForm').scrollIntoView({ 
        behavior: 'smooth', 
        block: 'start' 
    });
}

document.getElementById("userForm").addEventListener("submit", e => {
    e.preventDefault();
    
    // RÃ©cupÃ©rer les donnÃ©es du formulaire
    const formData = {
        sessionId: selectedSessionId,
        nom: document.getElementById('nom').value,
        prenom: document.getElementById('prenom').value,
        email: document.getElementById('email').value,
        telephone: document.getElementById('telephone').value,
        adresse: document.getElementById('adresse').value,
        codePostal: document.getElementById('codePostal').value
    };

    // Afficher les donnÃ©es dans la console
    console.log('Inscription enregistrÃ©e:', formData);
    
    // Masquer le formulaire et afficher le message de succÃ¨s
    document.getElementById("registrationForm").classList.remove("active");
    document.getElementById("successMessage").classList.add("active");
    
    // RÃ©initialiser le formulaire
    e.target.reset();
    
    // Scroll vers le message de succÃ¨s
    document.getElementById('successMessage').scrollIntoView({ 
        behavior: 'smooth' 
    });
});

const map = L.map("map").setView([48.38, -4.48], 10);

L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
    attribution: "Â© OpenStreetMap"
}).addTo(map);

sessions.forEach(session => {
    const marker = L.marker([session.lat, session.lng]).addTo(map);
    marker.bindPopup(`<strong>${session.titre}</strong><br>${session.plage}`);
    marker.on("click", () => selectSession(session.id));
});

// Initialiser la page
renderSessions();
</script>

<script src="js/layout.js"></script>
</body>
</html>